
        <!DOCTYPE html>
        <html>
            <head>
                <meta http-equiv="Content-Type" content="text/html; charset=gb2312">
                <title>Two-Period Pre-Post Analysis - Jimmy Z. Hu's Blog</title>
                <style rel="stylesheet" type="text/css">
                    body {font-family: Georgia; font-size: 17px;}
h2 {margin-top: 40px; border-bottom: 1px solid #999; text-transform: uppercase;}
p {text-align: left; line-height: 1.4em;}
pre {
    background: #f4f4f4; border: 1px solid #ddd; border-left: 3px solid #9f9f9f; 
    color: #666; page-break-inside: avoid; font-family: monospace; font-size: 15px; 
    line-height: 1.1; max-width: 100%; overflow: auto; padding: 0.5em 0.5em; 
    display: block; word-wrap: break-word;
}
li {line-height: 1.25em;}
a:link {text-decoration: none; color: blue;}
a:visited {text-decoration: none; color: blue;}
.container {width: 750px; margin-left: auto; margin-right: auto; padding: 50px 0 50px 0;}
.title {text-align: left;}
.katex {font-size: 1em !important;} 
table {width: 100%%;}
table, th, td {border: 1px solid black;}

                </style>
                <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
                <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
                <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"></script>
                <script>
                    document.addEventListener("DOMContentLoaded", function() {
                        renderMathInElement(document.body, {
                            delimiters: [
                              {left: "$$", right: "$$", display: true},
                              {left: "$", right: "$", display: false}
                            ] 
                        });
                    });
                </script>
            </head>
            <body>
                <div class="container">
                    <h1 class="title">Two-Period Pre-Post Analysis</h1>
                    2020-09-03
                    <span style="float:right; _position:relative;">
                        <a href="/home">HOME</a>
                        &ensp;
                        <a href="/notes">NOTES</a> &ensp; <a href="../">RELATED</a>
                    </span><br/>
                    <h2>Ryan, 2014</h2>
<p>Point estimates of policy effects using difference-in-differences can be generated by simply calculating the difference in means for a given outcome between treatment and comparison groups, before and after the intervention was initiated. However, regression models make it possible to test whether difference-in-differences estimates are statistically significant.</p>
<p>Because difference-in-difference analysis is implemented using regression analysis, these methods are subject to <strong>standard statistical assumptions</strong> (e.g., Gauss-Markov assumptions for linear regression) (Wooldridge 2009). The additional key assumptions for difference-in-difference analysis are the <strong>“common shocks”</strong> and <strong>“parallel trends”</strong> assumptions (Angrist and Pischke 2008).</p>
<p>When treatment was randomly assigned, the bias of alternative DID specifications was approximately equivalent. However, <strong>when the probability of treatment was correlated with preintervention levels or trends, propensity score matching resulted in much more accurate point estimates.</strong></p>
<ul>
<li><strong>Elements of Difference-in-Differences Checklist</strong></li>
</ul>
<table>
<thead>
<tr>
<th align="left">Confirm That</th>
<th align="left">How to Test</th>
<th align="left">What To Do If Violated</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">1. Data exist on study outcomes for at least one observation period among groups exposed and not exposed to an intervention, both before and after the intervention was implemented</td>
<td align="left">Directly observable</td>
<td align="left">NA</td>
</tr>
<tr>
<td align="left">2. Trends in outcome performance prior to an intervention are “parallel” between treatment and comparison groups</td>
<td align="left">Test equivalence of linear trends between treatment and comparison groups prior to intervention by testing the significance of the interaction term between the time trend and the treatment group</td>
<td align="left">If multiple comparison groups are available, match treatment and comparison units</td>
</tr>
<tr>
<td align="left">3. Baseline outcome levels are unrelated to expectations for changes in outcomes</td>
<td align="left">For both treatment and comparison groups, test whether baseline outcome is correlated with change in performance across the study period</td>
<td align="left">If multiple comparison groups are available, match treatment and comparison units</td>
</tr>
<tr>
<td align="left">4. Violations to standard statistical assumptions are appropriately addressed</td>
<td align="left">Test for violations of homoscedasticity of standard errors.(Breusch and Pagan 1979; Drukker 2003)</td>
<td align="left">Permutation tests or clustered standard errors will likely result in the most accurate statistical inference when using difference‐in‐difference analysis</td>
</tr>
<tr>
<td align="left">5. Events or factors other than treatment, occurring at the time of treatment, do not differentially affect outcomes for treatment and comparison groups</td>
<td align="left">Not directly testable</td>
<td align="left">NA</td>
</tr>
<tr>
<td align="left">6. The composition of treatment and comparison groups does not change over the course of the study</td>
<td align="left">Test for difference in observed covariates between treatment and comparison rates before and after the intervention. Test for differential drop‐out rates between treatment and comparison groups.(Hausman and Wise 1979)</td>
<td align="left">Control for differences in observed covariates between treatment and comparison rates before and after the intervention</td>
</tr>
<tr>
<td align="left">7. Treatment does not “spill‐over” from treatment group to comparison group</td>
<td align="left">Test whether comparison group experiences deviation from existing trend concurrent with intervention</td>
<td align="left">If multiple comparison groups are available, choose alternative comparison group that is not subject to spillovers</td>
</tr>
</tbody>
</table>
<h2>Estimating OLS for pre-post study designs</h2>
<ul>
<li><strong>Complete a D-i-D table using Stata and by hand</strong></li>
</ul>
<pre><code>margins, at(${pre/post}=0 ${T/C}=0 ${pre/post}${T/C}=0)
margins, at(${pre/post}=0 ${T/C}=1 ${pre/post}${T/C}=0)
margins, at(${pre/post}=1 ${T/C}=0 ${pre/post}${T/C}=0)
margins, at(${pre/post}=1 ${T/C}=1 ${pre/post}${T/C}=1)
</code></pre>
<table>
<thead>
<tr>
<th align="left">Pre</th>
<th align="left">Post</th>
<th align="left"><em>Difference</em></th>
<th align="left"></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><strong>Treatment</strong></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><strong>Comparison</strong></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><em><strong>Difference</strong></em></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<ul>
<li><strong>Use factor notation</strong></li>
</ul>
<pre><code>reg y i.${pre/post}##i.${T/C} ${coveriance}
</code></pre>
<p>, where we put “i.” before ${pre/post} and ${T/C} as they are dummy variables. For continuous variable, put “c.” before it.</p>
<pre><code>margins i.${pre/post}##i.${T/C}
//margins i.${T/C}, at(${coveriance}=(1 2 ...))
marginsplot
</code></pre>
<p>By using the “margins” commend, Stata will predict for each group (four groups in total)</p>

                    <p style="border-top: 1px solid #dbdbdb; margin-top: 40px;"></p>
                    <div id="valine-thread"></div>
                    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
                    <script src='/js/Valine.min.js'></script>
                    <script>
                        new Valine({
                            el: '#valine-thread',
                            appId: 'DSTtKETb5UeyXIjoPTpRnC8Y-gzGzoHsz',
                            appKey: 'csHaHWqxD2Ujv84O7jaJWOSc',
                            verify: false,
                            avatar: 'robohash',
                            placeholder: '',
                            meta: ['nick', 'mail'],
                            requiredFields: ['nick'],
                            visitor: true,
                            lang: 'en'
                        })
                    </script>
                  
                    <footer>
                        <p style="padding: 5px 0 0 0; text-align: center; font-size: .9rem; border-top: 1px solid #dbdbdb;margin-top: 40px;">&#169; 2021 Jimmy Z. Hu<br>This website is licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0.</a></p>
                    </footer>
                </div>
            </body>
        </html>
    